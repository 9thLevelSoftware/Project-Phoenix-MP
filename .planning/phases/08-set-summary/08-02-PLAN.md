---
phase: 08-set-summary
plan: 02
type: execute
wave: 2
depends_on: ["08-01"]
files_modified:
  - shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/SetSummaryCard.kt
autonomous: true

must_haves:
  truths:
    - "After completing a set, user sees force curve card with averaged concentric curve, sticking point annotation, and strength profile badge"
    - "Force curve card reuses Canvas drawing patterns from ForceCurveMiniGraph"
  artifacts:
    - path: "shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/SetSummaryCard.kt"
      provides: "ForceCurveSummaryCard composable with averaged curve, sticking point, strength profile badge"
      contains: "ForceCurveSummaryCard"
  key_links:
    - from: "SetSummaryCard.kt"
      to: "BiomechanicsSetSummary.avgForceCurve"
      via: "biomechanicsSummary.avgForceCurve"
      pattern: "avgForceCurve"
    - from: "SetSummaryCard.kt"
      to: "BiomechanicsSetSummary.strengthProfile"
      via: "biomechanicsSummary.strengthProfile"
      pattern: "strengthProfile"
---

<objective>
Add force curve summary card to the set summary screen showing the averaged concentric force curve with sticking point annotation and strength profile badge.

Purpose: Users see their force production pattern after each set, helping identify weak points in their range of motion.
Output: ForceCurveSummaryCard composable integrated into SetSummaryCard.
</objective>

<execution_context>
@C:/Users/dasbl/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/dasbl/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-set-summary/08-01-SUMMARY.md
@shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/SetSummaryCard.kt
@shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/components/ForceCurveMiniGraph.kt
@shared/src/commonMain/kotlin/com/devil/phoenixproject/domain/model/BiomechanicsModels.kt
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add ForceCurveSummaryCard to SetSummaryCard</name>
  <files>
    shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/SetSummaryCard.kt
  </files>
  <action>
    Add a force curve summary section to SetSummaryCard. This card is LARGER than the HUD mini-graph -- it's a full analysis card for post-set review.

    1. **Create ForceCurveSummaryCard composable** (private, in SetSummaryCard.kt) taking `avgForceCurve: ForceCurveResult, strengthProfile: StrengthProfile`:

       - Card with `surfaceContainerHigh` background, `RoundedCornerShape(16.dp)`
       - Header row: "Force Curve" title in `titleSmall` + Bold + `primary` color
       - **Strength profile badge** next to title: A small chip/badge showing the profile name. Map to display strings: ASCENDING = "Ascending", DESCENDING = "Descending", BELL_SHAPED = "Bell Curve", FLAT = "Flat". Use `SuggestionChip` or a simple `Surface` with rounded corners, `secondaryContainer` background.

       - **Force curve Canvas** (height = 120.dp, fillMaxWidth):
         - Draw the 101-point force curve as a smooth line using Path (same Canvas pattern as ForceCurveMiniGraph.kt)
         - Auto-scale Y axis to min/max of normalizedForceN array
         - X axis spread across canvas width (101 points)
         - Line color: `primary` at 2.dp stroke
         - Fill area under curve with `primary.copy(alpha = 0.15f)`
         - **Sticking point marker**: If `stickingPointPct` is non-null, draw a red circle at the sticking point position on the curve, plus a dashed vertical red line from top to bottom at that X position. Add a small "Sticking Point" label at the top of the line.

       - **Stats row** below canvas:
         - "Sticking Point": `"${stickingPointPct?.toInt() ?: "--"}% ROM"`
         - "Peak Force": find max of normalizedForceN, display as `"${max.toInt()} N"`
         - "Min Force": find min of normalizedForceN (excluding edges), display as `"${min.toInt()} N"`

       - **X-axis labels**: "0%" on left, "50%" center, "100%" on right (ROM %)

    2. **Insert ForceCurveSummaryCard** in SetSummaryCard layout -- Add after the VelocitySummaryCard (added in Plan 01). Wrap in:
       ```kotlin
       summary.biomechanicsSummary?.let { biomechanics ->
           biomechanics.avgForceCurve?.let { curve ->
               ForceCurveSummaryCard(
                   avgForceCurve = curve,
                   strengthProfile = biomechanics.strengthProfile
               )
           }
       }
       ```

    3. **Add imports**: `ForceCurveResult`, `StrengthProfile`, `Path`, `Stroke`, `drawscope` items as needed. Most Canvas imports are already present in SetSummaryCard.kt from the QualitySparkline and RadarChart.

    Do NOT reuse ForceCurveMiniGraph composable -- that is designed for the tiny HUD display. This card is larger with more detail (stats row, axis labels, sticking point annotation text).
  </action>
  <verify>
    `./gradlew :androidApp:assembleDebug` compiles successfully. Grep for `ForceCurveSummaryCard` in SetSummaryCard.kt confirms composable exists. Grep for `avgForceCurve` confirms conditional rendering.
  </verify>
  <done>
    Force curve summary card displays averaged concentric curve with sticking point marker, strength profile badge, peak/min force stats, and ROM axis labels (SUM-02, SUM-04, FORCE-06).
  </done>
</task>

</tasks>

<verification>
- `./gradlew :androidApp:assembleDebug` passes
- Force curve card renders with Canvas-drawn curve, sticking point red marker, strength profile badge
- Stats row shows sticking point %, peak force, min force
</verification>

<success_criteria>
- Force curve summary card visible on set completion when avgForceCurve is non-null
- Sticking point annotated with red marker and label
- Strength profile badge shows Ascending/Descending/Bell Curve/Flat
- Canvas auto-scales Y axis to data range
</success_criteria>

<output>
After completion, create `.planning/phases/08-set-summary/08-02-SUMMARY.md`
</output>
