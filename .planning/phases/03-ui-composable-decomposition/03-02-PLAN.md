---
phase: 03-ui-composable-decomposition
plan: 02
type: execute
wave: 2
depends_on: [03-01]
files_modified:
  - shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/WorkoutTab.kt
  - shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/WorkoutSetupDialog.kt
  - shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/ModeSubSelectorDialog.kt
autonomous: true
must_haves:
  truths:
    - "WorkoutSetupDialog lives in its own file with its companion ExercisePickerDialog"
    - "ModeSubSelectorDialog lives in its own file"
    - "WorkoutTab.kt is reduced from ~2,280 lines (post-plan-01) to ~1,350 lines"
    - "All composables render identically -- zero behavior changes"
    - "Build compiles and all existing tests pass"
  artifacts:
    - path: "shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/WorkoutSetupDialog.kt"
      provides: "WorkoutSetupDialog and simple ExercisePickerDialog"
      contains: "fun WorkoutSetupDialog"
    - path: "shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/ModeSubSelectorDialog.kt"
      provides: "ModeSubSelectorDialog"
      contains: "fun ModeSubSelectorDialog"
  key_links:
    - from: "WorkoutTab.kt"
      to: "WorkoutSetupDialog.kt"
      via: "same-package function call"
      pattern: "WorkoutSetupDialog\\("
    - from: "WorkoutSetupDialog.kt"
      to: "ModeSubSelectorDialog.kt"
      via: "same-package function call"
      pattern: "ModeSubSelectorDialog\\("
---

<objective>
Extract dialog composables from WorkoutTab.kt (2,840 lines, or ~2,280 post-plan-01) into separate focused files, reducing WorkoutTab to ~1,350 lines of core screen logic.

Purpose: Complete the WorkoutTab decomposition by pulling dialogs to their own files, matching the established pattern of dialog-per-file seen in ExerciseEditDialog.kt, ConnectionErrorDialog.kt, etc.

Output: Two new files (WorkoutSetupDialog.kt, ModeSubSelectorDialog.kt), one modified file (WorkoutTab.kt with dialogs removed).
</objective>

<execution_context>
@C:/Users/dasbl/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/dasbl/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-ui-composable-decomposition/03-RESEARCH.md

Key source files:
@shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/WorkoutTab.kt

NOTE: If Plan 03-01 has already executed, WorkoutTab.kt will be ~560 lines shorter (SetSummaryCard extracted). The line numbers below are from the ORIGINAL 2,840-line file -- adjust accordingly if the file has already been modified.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract WorkoutSetupDialog and ExercisePickerDialog to WorkoutSetupDialog.kt</name>
  <files>
    shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/WorkoutSetupDialog.kt
    shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/WorkoutTab.kt
  </files>
  <action>
1. Create `WorkoutSetupDialog.kt` in `presentation/screen/` with package `com.devil.phoenixproject.presentation.screen`.

2. Move these composables from WorkoutTab.kt into the new file:
   - `WorkoutSetupDialog` (public, ~lines 2041-2471 in original) -- the main setup dialog with mode selection, weight, exercise picker
   - `ExercisePickerDialog` (public, ~lines 2649-2798 in original) -- the SIMPLE 3-param version local to the workout setup flow

3. Copy ONLY the imports needed by these two composables. Audit carefully.

IMPORTANT -- DUPLICATE ExercisePickerDialog WARNING:
- The version being moved is the SIMPLE one (3 params: exerciseRepository, onDismiss, onExerciseSelected)
- A DIFFERENT, feature-rich version exists at `components/ExercisePicker.kt` (9 params)
- Do NOT merge or modify either version. Keep the simple version as-is in WorkoutSetupDialog.kt
- Since both are in different packages (screen vs components), there is no naming conflict

4. Remove the moved composables from WorkoutTab.kt.

VISIBILITY RULES:
- `WorkoutSetupDialog` stays public (called from WorkoutTab)
- `ExercisePickerDialog` stays public (called from WorkoutSetupDialog; same package means no import needed)

DO NOT change any function signatures, parameter names, or implementation logic. This is a move-only operation.
  </action>
  <verify>
Run `./gradlew :shared:compileKotlinAndroid` to verify the build compiles. WorkoutTab.kt should resolve WorkoutSetupDialog from the same package without import changes.
  </verify>
  <done>
WorkoutSetupDialog.kt exists with WorkoutSetupDialog and the simple ExercisePickerDialog. WorkoutTab.kt no longer contains these composables. Build compiles cleanly.
  </done>
</task>

<task type="auto">
  <name>Task 2: Extract ModeSubSelectorDialog and clean up WorkoutTab.kt imports</name>
  <files>
    shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/ModeSubSelectorDialog.kt
    shared/src/commonMain/kotlin/com/devil/phoenixproject/presentation/screen/WorkoutTab.kt
  </files>
  <action>
1. Create `ModeSubSelectorDialog.kt` in `presentation/screen/` with package `com.devil.phoenixproject.presentation.screen`.

2. Move `ModeSubSelectorDialog` (public, ~lines 2476-2648 in original) from WorkoutTab.kt into the new file.

3. Copy ONLY the imports needed by ModeSubSelectorDialog.

4. Remove ModeSubSelectorDialog from WorkoutTab.kt.

5. Clean up WorkoutTab.kt imports -- remove any imports that are no longer needed after extracting dialogs and SetSummaryCard (from Plan 03-01). Run the Kotlin compiler to identify unused imports, or manually audit the import block against remaining composables.

VISIBILITY RULES:
- `ModeSubSelectorDialog` stays public (called from WorkoutSetupDialog)

DO NOT change any function signatures, parameter names, or implementation logic. This is a move-only operation.
  </action>
  <verify>
Run `./gradlew :shared:compileKotlinAndroid` to verify the build compiles. Then run `./gradlew :shared:testDebugUnitTest` to verify all characterization tests still pass. Verify WorkoutTab.kt is now ~1,350 lines or less.
  </verify>
  <done>
ModeSubSelectorDialog.kt exists (~172 lines). WorkoutTab.kt imports are clean (no unused imports). WorkoutTab.kt is ~1,350 lines or less. Build compiles and all tests pass.
  </done>
</task>

</tasks>

<verification>
1. `./gradlew :shared:compileKotlinAndroid` -- build compiles with zero errors
2. `./gradlew :shared:testDebugUnitTest` -- all 38 characterization tests pass
3. `WorkoutSetupDialog.kt` and `ModeSubSelectorDialog.kt` exist as new files
4. `WorkoutTab.kt` is ~1,350 lines or less (down from 2,840)
5. No import changes needed in any file outside the split targets (same-package visibility)
6. WorkoutTabPreviews.kt (androidMain) still compiles -- same-package resolution
</verification>

<success_criteria>
- WorkoutSetupDialog, ExercisePickerDialog (simple), and ModeSubSelectorDialog each live outside WorkoutTab.kt
- WorkoutTab.kt is reduced to ~1,350 lines of core screen logic
- All composable signatures are identical (zero behavioral change)
- Build compiles and all tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/03-ui-composable-decomposition/03-02-SUMMARY.md`
</output>
